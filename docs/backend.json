{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "description": "Represents a user's profile in the system.",
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "The user's unique ID, matching their Firebase Auth UID."
        },
        "email": {
          "type": "string",
          "format": "email",
          "description": "The user's email address."
        },
        "companyName": {
          "type": "string",
          "description": "The name of the company the user belongs to."
        },
        "tenantId": {
          "type": "string",
          "description": "The ID of the tenant (organization) the user belongs to."
        }
      },
      "required": ["id", "email", "tenantId"]
    },
    "Tenant": {
      "title": "Tenant",
      "description": "Represents a tenant organization.",
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "description": "The name of the tenant organization."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns/created the tenant."
        }
      },
      "required": ["name", "ownerId"]
    },
    "Device": {
      "title": "Device",
      "description": "Represents a managed endpoint device.",
      "type": "object",
      "properties": {
        "deviceName": {
          "type": "string",
          "description": "The name of the device."
        },
        "os": {
          "type": "string",
          "description": "Operating system of the device."
        },
        "riskLevel": {
          "type": "string",
          "enum": ["High", "Medium", "Low"]
        },
        "status": {
          "type": "string",
          "enum": ["Online", "Offline", "Isolated", "Decommissioned"]
        },
        "policy": {
          "type": "string",
          "enum": ["Strict", "Balanced", "Lenient"]
        },
        "ipAddress": {
          "type": "string"
        },
        "lastSeen": {
          "type": "string",
          "format": "date-time"
        },
        "createdAt": {
          "type": "string",
          "format": "date-time"
        },
        "isolated": {
          "type": "boolean",
          "description": "Whether the device is isolated from the network."
        },
        "isolatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the device was isolated."
        },
        "policyUpdatedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the policy was last updated."
        },
        "decommissionedAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the device was decommissioned."
        }
      },
      "required": [
        "deviceName",
        "os",
        "riskLevel",
        "status",
        "policy",
        "createdAt",
        "isolated"
      ]
    },
    "ThreatAlert": {
      "title": "Threat Alert",
      "description": "Represents a security alert for a specific device.",
      "type": "object",
      "properties": {
        "type": {
          "type": "string"
        },
        "severity": {
          "type": "string",
          "enum": ["High", "Medium", "Low"]
        },
        "status": {
          "type": "string",
          "enum": ["Active", "Resolved", "Quarantined"]
        },
        "detectedAt": {
          "type": "string",
          "format": "date-time"
        },
        "engine": {
          "type": "string"
        },
        "description": {
          "type": "string"
        }
      },
      "required": ["type", "severity", "status", "detectedAt"]
    },
    "AuditLog": {
      "title": "Audit Log",
      "description": "Records an auditable action performed by a user.",
      "type": "object",
      "properties": {
        "action": {
          "type": "string",
          "description": "The type of action performed (e.g., 'DEVICE_ISOLATED')."
        },
        "targetId": {
          "type": "string",
          "description": "The ID of the entity that was acted upon (e.g., a deviceId)."
        },
        "userId": {
          "type": "string",
          "description": "The UID of the user who performed the action."
        },
        "createdAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the action occurred."
        },
        "metadata": {
          "type": "object",
          "description": "Any extra metadata associated with the action."
        }
      },
      "required": ["action", "targetId", "userId", "createdAt"]
    },
    "EnrollmentToken": {
      "title": "Enrollment Token",
      "description": "A one-time token used to enroll a new device.",
      "type": "object",
      "properties": {
        "token": {
          "type": "string",
          "description": "The unique token value."
        },
        "expiresAt": {
          "type": "string",
          "format": "date-time",
          "description": "Timestamp when the token expires."
        },
        "used": {
          "type": "boolean",
          "description": "Whether the token has been used."
        },
        "createdBy": {
          "type": "string",
          "description": "The UID of the user who created the token."
        },
        "createdAt": {
            "type": "string",
            "format": "date-time",
            "description": "Timestamp when the token was created."
        }
      },
      "required": ["token", "expiresAt", "used", "createdBy", "createdAt"]
    }
  },
  "auth": {
    "providers": ["password"]
  },
  "firestore": {
    "/users/{userId}": {
      "schema": {
        "$ref": "#/entities/UserProfile"
      },
      "description": "Stores public information about a user."
    },
    "/tenants/{tenantId}": {
      "schema": {
        "$ref": "#/entities/Tenant"
      },
      "description": "Stores information about a tenant organization."
    },
    "/tenants/{tenantId}/devices/{deviceId}": {
      "schema": {
        "$ref": "#/entities/Device"
      },
      "description": "Stores devices belonging to a specific tenant."
    },
    "/tenants/{tenantId}/devices/{deviceId}/alerts/{alertId}": {
      "schema": {
        "$ref": "#/entities/ThreatAlert"
      },
      "description": "Stores security alerts for a specific device within a tenant."
    },
    "/tenants/{tenantId}/auditLogs/{logId}": {
      "schema": {
        "$ref": "#/entities/AuditLog"
      },
      "description": "Stores audit log entries for a specific tenant."
    },
    "/tenants/{tenantId}/enrollmentTokens/{tokenId}": {
      "schema": {
        "$ref": "#/entities/EnrollmentToken"
      },
      "description": "Stores single-use tokens for device enrollment."
    }
  }
}
